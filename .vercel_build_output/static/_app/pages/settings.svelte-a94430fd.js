import{D as R,S as B,i as H,s as O,l as V,g as D,e as b,t as S,k as C,c as k,a as L,h as T,d as g,m as M,b as w,K as f,F as U,j as z,H as P,L as Q,V as A,Q as W,U as J}from"../chunks/vendor-0cb8730d.js";import{c as q}from"../chunks/curLocation-0ca46c2b.js";const I=R({networks:[]});function N(o,e,s){const t=o.slice();return t[7]=e[s].location,t[9]=s,t}function F(o){let e,s,t=o[7].city+"",a,i,h,u=o[7].country+"",p,m,d,_;function c(){return o[5](o[9])}return{c(){e=b("li"),s=b("div"),a=S(t),i=C(),h=b("p"),p=S(u),m=C(),this.h()},l(l){e=k(l,"LI",{class:!0});var r=L(e);s=k(r,"DIV",{class:!0});var n=L(s);a=T(n,t),n.forEach(g),i=M(r),h=k(r,"P",{class:!0});var v=L(h);p=T(v,u),v.forEach(g),m=M(r),r.forEach(g),this.h()},h(){w(s,"class","grow text-left text-lg font-semibold"),w(h,"class","ml-auto text-base"),w(e,"class","my-0.5 flex flex-row justify-center gap-4 px-4 w-full relative active:bg-lime-200 hover:bg-lime-100 transition-colors bg-lime-50 duration-300")},m(l,r){D(l,e,r),f(e,s),f(s,a),f(e,i),f(e,h),f(h,p),f(e,m),d||(_=U(e,"click",c),d=!0)},p(l,r){o=l,r&2&&t!==(t=o[7].city+"")&&z(a,t),r&2&&u!==(u=o[7].country+"")&&z(p,u)},d(l){l&&g(e),d=!1,_()}}}function G(o){let e=o[7].city.toLowerCase().startsWith(o[0].toLowerCase())||o[7].country.toLowerCase().startsWith(o[0].toLowerCase()),s,t=e&&F(o);return{c(){t&&t.c(),s=V()},l(a){t&&t.l(a),s=V()},m(a,i){t&&t.m(a,i),D(a,s,i)},p(a,i){i&3&&(e=a[7].city.toLowerCase().startsWith(a[0].toLowerCase())||a[7].country.toLowerCase().startsWith(a[0].toLowerCase())),e?t?t.p(a,i):(t=F(a),t.c(),t.m(s.parentNode,s)):t&&(t.d(1),t=null)},d(a){t&&t.d(a),a&&g(s)}}}function X(o){let e,s,t,a,i,h,u,p,m,d,_=o[1].networks,c=[];for(let l=0;l<_.length;l+=1)c[l]=G(N(o,_,l));return{c(){e=b("div"),s=b("div"),t=b("input"),a=C(),i=b("ul");for(let l=0;l<c.length;l+=1)c[l].c();h=C(),u=b("button"),p=S("Get locations"),this.h()},l(l){e=k(l,"DIV",{class:!0});var r=L(e);s=k(r,"DIV",{class:!0});var n=L(s);t=k(n,"INPUT",{class:!0,placeholder:!0,type:!0}),n.forEach(g),a=M(r),i=k(r,"UL",{class:!0});var v=L(i);for(let j=0;j<c.length;j+=1)c[j].l(v);v.forEach(g),h=M(r),u=k(r,"BUTTON",{class:!0});var y=L(u);p=T(y,"Get locations"),y.forEach(g),r.forEach(g),this.h()},h(){w(t,"class","bg-lime-200 px-2 py-1 rounded-md w-full shadow-sm border-black border"),w(t,"placeholder","Search"),w(t,"type","text"),w(s,"class","w-full p-4 z-40"),w(i,"class","w-full relative overflow-scroll z-40"),w(u,"class","button z-40"),w(e,"class","w-full h-[calc(100%-6rem)] flex flex-col items-center justify-cente z-40")},m(l,r){D(l,e,r),f(e,s),f(s,t),f(e,a),f(e,i);for(let n=0;n<c.length;n+=1)c[n].m(i,null);f(e,h),f(e,u),f(u,p),m||(d=[U(t,"input",o[4]),U(u,"click",o[2])],m=!0)},p(l,[r]){if(r&3){_=l[1].networks;let n;for(n=0;n<_.length;n+=1){const v=N(l,_,n);c[n]?c[n].p(v,r):(c[n]=G(v),c[n].c(),c[n].m(i,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=_.length}},i:P,o:P,d(l){l&&g(e),Q(c,l),m=!1,A(d)}}}const Y="https://api.citybik.es/v2/networks/";function K(o,e,s,t){var a=6371,i=E(s-o),h=E(t-e),u=Math.sin(i/2)*Math.sin(i/2)+Math.cos(E(o))*Math.cos(E(s))*Math.sin(h/2)*Math.sin(h/2),p=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),m=a*p;return m}function E(o){return o*(Math.PI/180)}function Z(o,e,s){let t,a;W(o,q,d=>s(3,t=d)),W(o,I,d=>s(1,a=d));let i="";const h=()=>{localStorage.setItem("prevLoc",t)},u=async()=>{const d=await J.get(Y,{});I.set(d.data),I.subscribe(_=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(c=>{const l=[..._.networks];l.sort((r,n)=>{const v=K(c.coords.latitude,c.coords.longitude,r.location.latitude,r.location.longitude),y=K(c.coords.latitude,c.coords.longitude,n.location.latitude,n.location.longitude);return v-y}),I.set({networks:l})})})},p=d=>{s(0,i=d.currentTarget.value)},m=d=>{q.set(a.networks[d].id),console.log(a.networks[d].id)};return o.$$.update=()=>{o.$$.dirty&8&&h()},[i,a,u,t,p,m]}class tt extends B{constructor(e){super();H(this,e,Z,X,O,{})}}export{tt as default};
