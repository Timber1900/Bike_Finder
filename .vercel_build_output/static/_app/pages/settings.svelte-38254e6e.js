import{D as R,S as A,i as H,s as N,l as S,g as E,e as L,t as V,k as D,c as w,a as k,h as G,d as g,m as C,b,K as f,F as j,j as T,H as U,L as Q,V as J,Q as z,U as X}from"../chunks/vendor-0cb8730d.js";import{c as P}from"../chunks/curLocation-0ca46c2b.js";const O=R({networks:[]});var W;(function(e){e.DataLicenceGermanyAttributionVersion20="Data licence Germany \u2013 attribution \u2013 version 2.0",e.OGLV3License="OGL v3 license",e.OpenDataCommonsOpenDatabaseLicense10ODBL="Open Data Commons Open Database License 1.0 (ODbL)",e.OpenLicence="Open Licence"})(W||(W={}));function q(e,o,s){const t=e.slice();return t[7]=o[s].location,t[9]=s,t}function B(e){let o,s,t=e[7].city+"",a,i,h,u=e[7].country+"",p,m,d,v;function c(){return e[5](e[9])}return{c(){o=L("li"),s=L("div"),a=V(t),i=D(),h=L("p"),p=V(u),m=D(),this.h()},l(n){o=w(n,"LI",{class:!0});var l=k(o);s=w(l,"DIV",{class:!0});var r=k(s);a=G(r,t),r.forEach(g),i=C(l),h=w(l,"P",{class:!0});var _=k(h);p=G(_,u),_.forEach(g),m=C(l),l.forEach(g),this.h()},h(){b(s,"class","grow text-left text-lg font-semibold"),b(h,"class","ml-auto text-base"),b(o,"class","my-0.5 flex flex-row justify-center gap-4 px-4 w-full relative active:bg-lime-200 hover:bg-lime-100 transition-colors bg-lime-50 duration-300")},m(n,l){E(n,o,l),f(o,s),f(s,a),f(o,i),f(o,h),f(h,p),f(o,m),d||(v=j(o,"click",c),d=!0)},p(n,l){e=n,l&2&&t!==(t=e[7].city+"")&&T(a,t),l&2&&u!==(u=e[7].country+"")&&T(p,u)},d(n){n&&g(o),d=!1,v()}}}function F(e){let o=e[7].city.toLowerCase().startsWith(e[0].toLowerCase())||e[7].country.toLowerCase().startsWith(e[0].toLowerCase()),s,t=o&&B(e);return{c(){t&&t.c(),s=S()},l(a){t&&t.l(a),s=S()},m(a,i){t&&t.m(a,i),E(a,s,i)},p(a,i){i&3&&(o=a[7].city.toLowerCase().startsWith(a[0].toLowerCase())||a[7].country.toLowerCase().startsWith(a[0].toLowerCase())),o?t?t.p(a,i):(t=B(a),t.c(),t.m(s.parentNode,s)):t&&(t.d(1),t=null)},d(a){t&&t.d(a),a&&g(s)}}}function Y(e){let o,s,t,a,i,h,u,p,m,d,v=e[1].networks,c=[];for(let n=0;n<v.length;n+=1)c[n]=F(q(e,v,n));return{c(){o=L("div"),s=L("div"),t=L("input"),a=D(),i=L("ul");for(let n=0;n<c.length;n+=1)c[n].c();h=D(),u=L("button"),p=V("Get locations"),this.h()},l(n){o=w(n,"DIV",{class:!0});var l=k(o);s=w(l,"DIV",{class:!0});var r=k(s);t=w(r,"INPUT",{class:!0,placeholder:!0,type:!0}),r.forEach(g),a=C(l),i=w(l,"UL",{class:!0});var _=k(i);for(let I=0;I<c.length;I+=1)c[I].l(_);_.forEach(g),h=C(l),u=w(l,"BUTTON",{class:!0});var y=k(u);p=G(y,"Get locations"),y.forEach(g),l.forEach(g),this.h()},h(){b(t,"class","bg-lime-200 px-2 py-1 rounded-md w-full shadow-sm border-black border"),b(t,"placeholder","Search"),b(t,"type","text"),b(s,"class","w-full p-4 z-40"),b(i,"class","w-full relative overflow-scroll z-40"),b(u,"class","button z-40"),b(o,"class","w-full h-[calc(100%-6rem)] flex flex-col items-center justify-cente z-40")},m(n,l){E(n,o,l),f(o,s),f(s,t),f(o,a),f(o,i);for(let r=0;r<c.length;r+=1)c[r].m(i,null);f(o,h),f(o,u),f(u,p),m||(d=[j(t,"input",e[4]),j(u,"click",e[2])],m=!0)},p(n,[l]){if(l&3){v=n[1].networks;let r;for(r=0;r<v.length;r+=1){const _=q(n,v,r);c[r]?c[r].p(_,l):(c[r]=F(_),c[r].c(),c[r].m(i,null))}for(;r<c.length;r+=1)c[r].d(1);c.length=v.length}},i:U,o:U,d(n){n&&g(o),Q(c,n),m=!1,J(d)}}}const Z="http://api.citybik.es/v2/networks/";function K(e,o,s,t){var a=6371,i=M(s-e),h=M(t-o),u=Math.sin(i/2)*Math.sin(i/2)+Math.cos(M(e))*Math.cos(M(s))*Math.sin(h/2)*Math.sin(h/2),p=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),m=a*p;return m}function M(e){return e*(Math.PI/180)}function x(e,o,s){let t,a;z(e,P,d=>s(3,t=d)),z(e,O,d=>s(1,a=d));let i="";const h=()=>{localStorage.setItem("prevLoc",t)},u=async()=>{const d=await X.get(Z,{});O.set(d.data),O.subscribe(v=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(c=>{const n=[...v.networks];n.sort((l,r)=>{const _=K(c.coords.latitude,c.coords.longitude,l.location.latitude,l.location.longitude),y=K(c.coords.latitude,c.coords.longitude,r.location.latitude,r.location.longitude);return _-y}),O.set({networks:n})})})},p=d=>{s(0,i=d.currentTarget.value)},m=d=>{P.set(a.networks[d].id),console.log(a.networks[d].id)};return e.$$.update=()=>{e.$$.dirty&8&&h()},[i,a,u,t,p,m]}class et extends A{constructor(o){super();H(this,o,x,Y,N,{})}}export{et as default};
